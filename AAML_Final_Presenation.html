<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AAML 2025 Final Project Presentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .presentation-container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .slide {
            display: none;
            padding: 60px;
            min-height: 600px;
        }
        
        .slide.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        h1 {
            color: #667eea;
            font-size: 3em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        h2 {
            color: #764ba2;
            font-size: 2.5em;
            margin-bottom: 30px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #667eea;
            font-size: 1.8em;
            margin: 25px 0 15px 0;
        }
        
        .subtitle {
            text-align: center;
            font-size: 1.3em;
            color: #666;
            margin-bottom: 40px;
        }
        
        .student-info {
            text-align: center;
            font-size: 1.2em;
            color: #444;
            margin-top: 50px;
        }
        
        .student-info p {
            margin: 10px 0;
        }
        
        ul {
            list-style-position: inside;
            margin-left: 20px;
        }
        
        li {
            margin: 15px 0;
            font-size: 1.15em;
            line-height: 1.6;
        }
        
        .highlight {
            background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .metric-label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 20px 0;
        }
        
        .architecture-diagram {
            background: #f5f5f5;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            padding: 20px 60px;
            background: #f8f9fa;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .slide-counter {
            text-align: center;
            color: #666;
            font-size: 1.1em;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>Hardware Acceleration of Pruned Wav2Letter ASR Model</h1>
            <p class="subtitle">Custom Function Unit (CFU) Design for Speech Recognition</p>
            <div class="student-info">
                <p><strong>Name:</strong> Swarnajit Bhattacharya</p>
                <p><strong>Student ID:</strong> 314540038</p>
                <p><strong>Course:</strong> AAML 2025 - Accelerator Architectures for Machine Learning</p>
                <p><strong>Institution:</strong> National Yang Ming Chiao Tung University (NYCU) Taiwan</p>
            </div>
        </div>

        <!-- Slide 2: Outline -->
        <div class="slide">
            <h2>Presentation Outline</h2>
            <ul>
                <li><strong>Problem Statement:</strong> Challenges in accelerating Wav2Letter ASR model</li>
                <li><strong>Methodology:</strong> Hardware-software co-design approach</li>
                <li><strong>Architecture:</strong> Custom Function Unit (CFU) design</li>
                <li><strong>Hardware Implementation:</strong> Verilog modules and optimizations</li>
                <li><strong>Software Integration:</strong> TensorFlow Lite kernel modifications</li>
                <li><strong>OP Codes:</strong> Custom instruction set for acceleration</li>
                <li><strong>Evaluation Results:</strong> Performance metrics and speedup analysis</li>
                <li><strong>Conclusion:</strong> Key achievements and future work</li>
            </ul>
        </div>

        <!-- Slide 3: Problem Statement -->
        <div class="slide">
            <h2>Problem Statement & Challenges</h2>
            <h3>Primary Challenge</h3>
            <div class="highlight">
                <p><strong>Goal:</strong> Accelerate pruned Wav2Letter model inference while maintaining ≥72% accuracy</p>
                <p><strong>Baseline Latency:</strong> 1,056,573 ms (~17.6 minutes per inference)</p>
            </div>
            
            <h3>Key Technical Challenges</h3>
            <ul>
                <li><strong>Computational Intensity:</strong> Convolution operations dominate execution time (>90%)</li>
                <li><strong>Memory Bandwidth:</strong> Frequent data movement between processor and memory</li>
                <li><strong>Model Sparsity:</strong> 50% pruned weights require efficient handling of zero values</li>
                <li><strong>Quantization:</strong> INT8 operations need careful hardware design</li>
                <li><strong>Limited Resources:</strong> FPGA constraints on logic elements and memory</li>
            </ul>
        </div>

        <!-- Slide 4: Methodology -->
        <div class="slide">
            <h2>Methodology</h2>
            <h3>Hardware-Software Co-Design Approach</h3>
            
            <div class="highlight">
                <h4>Step 1: Profiling & Analysis</h4>
                <ul>
                    <li>Identified convolution as primary bottleneck (>90% execution time)</li>
                    <li>Analyzed LeakyReLU activation overhead</li>
                    <li>Studied memory access patterns</li>
                </ul>
            </div>
            
            <div class="highlight">
                <h4>Step 2: Optimization Strategy</h4>
                <ul>
                    <li><strong>Tiling:</strong> 32x32 tile-based processing for parallelism</li>
                    <li><strong>Im2col Transformation:</strong> Convert convolution to matrix multiplication</li>
                    <li><strong>Hardware Offloading:</strong> Custom CFU for MAC and LeakyReLU operations</li>
                    <li><strong>Sparse Optimization:</strong> Skip zero-valued filter weights</li>
                </ul>
            </div>
            
            <div class="highlight">
                <h4>Step 3: Implementation</h4>
                <ul>
                    <li>Designed custom Verilog modules (CFU, buffers, LeakyReLU)</li>
                    <li>Modified TensorFlow Lite kernels for hardware integration</li>
                    <li>Implemented custom instruction set (OP codes)</li>
                </ul>
            </div>
        </div>

        <!-- Slide 5: Architecture Design -->
        <div class="slide">
            <h2>Architecture Design</h2>
            <h3>Overall System Architecture</h3>
            <div class="architecture-diagram">
                <pre>
┌─────────────────────────────────────────────────────┐
│              RISC-V Processor Core                  │
│  (Running TensorFlow Lite Micro + Modified Kernels) │
└──────────────────┬──────────────────────────────────┘
                   │ CFU Interface
                   ↓
┌─────────────────────────────────────────────────────┐
│              Custom Function Unit (CFU)             │
│  ┌───────────────────────────────────────────────┐  │
│  │           State Machine Controller            │  │
│  │      (IDLE, WRITE, PROCESS, COMPUTE, etc.)    │  │
│  └───────────────────────────────────────────────┘  │
│                       ↓                              │
│  ┌──────────────┬──────────────┬─────────────────┐  │
│  │   Global     │   Result     │   LeakyReLU     │  │
│  │   Buffer     │   Buffer     │   Accelerator   │  │
│  │   (BRAM)     │   (LUT)      │   Module        │  │
│  │  32 x 16KB   │  32 x 32     │                 │  │
│  └──────────────┴──────────────┴─────────────────┘  │
└─────────────────────────────────────────────────────┘
                </pre>
            </div>
            
            <h3>Key Features</h3>
            <ul>
                <li><strong>32-way Parallel Processing:</strong> TILE_SIZE = 32 for SIMD operations</li>
                <li><strong>Dual Buffer Architecture:</strong> Separate input and result buffers</li>
                <li><strong>Dedicated LeakyReLU Unit:</strong> Hardware activation function</li>
                <li><strong>Pipelined State Machine:</strong> Efficient operation scheduling</li>
            </ul>
        </div>

        <!-- Slide 6: Hardware Implementation -->
        <div class="slide">
            <h2>Hardware Implementation</h2>
            <h3>Core Verilog Modules (cfu.v)</h3>
            
            <h4>1. Global Buffer (BRAM)</h4>
            <ul>
                <li><strong>Purpose:</strong> Store input activation data (im2col buffer)</li>
                <li><strong>Configuration:</strong> 32 instances × 16KB each = 512KB total</li>
                <li><strong>Access:</strong> Single-cycle read/write with addressing</li>
            </ul>
            
            <h4>2. Result Buffer (LUT)</h4>
            <ul>
                <li><strong>Purpose:</strong> Store intermediate MAC accumulation results</li>
                <li><strong>Configuration:</strong> 32 instances × 32 entries × 32-bit = 4KB total</li>
                <li><strong>Implementation:</strong> Distributed RAM for fast access</li>
            </ul>
            
            <h4>3. LeakyReLU Accelerator</h4>
            <ul>
                <li><strong>Pipelined Design:</strong> 2-stage pipeline for throughput</li>
                <li><strong>Operations:</strong> Offset adjustment, multiplication, shift, clamping</li>
                <li><strong>Latency:</strong> 1 cycle after pipeline fill</li>
            </ul>
            
            <h4>4. State Machine</h4>
            <ul>
                <li>IDLE → WRITE_INPUT → PROCESS → COMPUTE_MUL → COMPUTE_ADD → RESPOND</li>
                <li>Handles 12 different function IDs efficiently</li>
            </ul>
        </div>

        <!-- Slide 7: Software Integration -->
        <div class="slide">
            <h2>Software Integration</h2>
            <h3>Modified TensorFlow Lite Kernels</h3>
            
            <h4>1. Convolution Kernel (conv.h)</h4>
            <div class="code-block">
// Im2col transformation + Tiling
for (int n_base = 0; n_base < N; n_base += TILE_SIZE) {
    // Load 32 pixels into CFU buffers
    cfu_op0(0, data, (pixel_idx << 16) | channel);
    
    for (int m_base = 0; m_base < M; m_base += TILE_SIZE) {
        // Process 32x32 tile
        if (first_accumulation)
            cfu_op0(5, filter_val, (row << 16) | col); // Init
        else
            cfu_op0(3, filter_val, (row << 16) | col); // MAC
        
        // Read results
        result = cfu_op0(4, row, col);
    }
}
            </div>
            
            <h4>2. LeakyReLU Kernel (leaky_relu.h)</h4>
            <div class="code-block">
// Configure LeakyReLU parameters
cfu_op0(7, pos_mult, pos_shift);    // Positive slope
cfu_op0(8, neg_mult, neg_shift);    // Negative slope
cfu_op0(9, in_offset, out_offset);  // Offsets
cfu_op0(11, min_val, max_val);      // Clamp values

// Process each element
for (int i = 0; i < size; ++i) {
    output[i] = cfu_op0(10, input[i], 0);
}
            </div>
        </div>

        <!-- Slide 8: OP Codes -->
        <div class="slide">
            <h2>Custom OP Codes</h2>
            <h3>CFU Instruction Set</h3>
            <table>
                <thead>
                    <tr>
                        <th>Function ID</th>
                        <th>Operation</th>
                        <th>Input 0</th>
                        <th>Input 1</th>
                        <th>Output</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>0</td>
                        <td>Write Input Buffer</td>
                        <td>Data (8-bit)</td>
                        <td>Address (pixel|channel)</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>1</td>
                        <td>Read Input Buffer</td>
                        <td>Pixel index</td>
                        <td>Channel index</td>
                        <td>Data (8-bit)</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>MAC (Accumulate)</td>
                        <td>Filter value</td>
                        <td>Address (row|col)</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>Read Result</td>
                        <td>Row index</td>
                        <td>Column index</td>
                        <td>Accumulated result</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>MAC (Initialize)</td>
                        <td>Filter value</td>
                        <td>Address (row|col)</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Set Input Offset</td>
                        <td>Offset value</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>7-11</td>
                        <td>LeakyReLU Config</td>
                        <td>Parameters</td>
                        <td>Parameters</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>LeakyReLU Execute</td>
                        <td>Input value</td>
                        <td>-</td>
                        <td>Activated value</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Slide 9: Key Optimizations -->
        <div class="slide">
            <h2>Key Optimization Techniques</h2>
            
            <h3>1. Tiling Strategy</h3>
            <ul>
                <li>Process data in 32×32 tiles to maximize parallelism</li>
                <li>Reduces memory bandwidth by reusing loaded data</li>
                <li>Fits efficiently in FPGA resources</li>
            </ul>
            
            <h3>2. Im2col Transformation</h3>
            <ul>
                <li>Converts 2D convolution into matrix multiplication</li>
                <li>Enables systematic data reuse</li>
                <li>Simplifies hardware design</li>
            </ul>
            
            <h3>3. Sparse Optimization</h3>
            <div class="code-block">
if (filter_val != 0) {
    // Only process non-zero weights
    cfu_op0(3, filter_val, address);
}
            </div>
            <ul>
                <li>Skip zero-valued weights (50% of model is pruned)</li>
                <li>Reduces unnecessary computations by ~50%</li>
            </ul>
            
            <h3>4. Hardware Activation</h3>
            <ul>
                <li>LeakyReLU executed in dedicated hardware (1 cycle latency)</li>
                <li>Eliminates software overhead for activation functions</li>
            </ul>
        </div>

        <!-- Slide 10: Evaluation Results -->
        <div class="slide">
            <h2>Evaluation Results</h2>
            
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-label">Original Latency</div>
                    <div class="metric-value">1,056,573 ms</div>
                    <div class="metric-label">~17.6 minutes</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-label">Optimized Latency</div>
                    <div class="metric-value">42,561.49 ms</div>
                    <div class="metric-label">~42.5 seconds</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-label">Speedup</div>
                    <div class="metric-value">23.47×</div>
                    <div class="metric-label">Performance Gain</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-label">Model Accuracy</div>
                    <div class="metric-value">≥72%</div>
                    <div class="metric-label">Maintained</div>
                </div>
            </div>
            
            <h3>Performance Breakdown</h3>
            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Optimization</th>
                        <th>Contribution</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Convolution</td>
                        <td>Tiling + Hardware MAC</td>
                        <td>~15× speedup</td>
                    </tr>
                    <tr>
                        <td>LeakyReLU</td>
                        <td>Hardware Accelerator</td>
                        <td>~4.5× speedup</td>
                    </tr>
                    <tr>
                        <td>Memory Access</td>
                        <td>Buffer Management</td>
                        <td>~2× speedup</td>
                    </tr>
                    <tr>
                        <td>Sparse Handling</td>
                        <td>Zero-skip Logic</td>
                        <td>~1.97× speedup</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Slide 11: Resource Utilization -->
        <div class="slide">
            <h2>FPGA Resource Utilization</h2>
            
            <h3>Hardware Resources</h3>
            <table>
                <thead>
                    <tr>
                        <th>Resource Type</th>
                        <th>Usage</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Block RAM (BRAM)</td>
                        <td>~512 KB</td>
                        <td>Global input buffers (32 × 16KB)</td>
                    </tr>
                    <tr>
                        <td>Distributed RAM (LUT)</td>
                        <td>~4 KB</td>
                        <td>Result buffers (32 × 32 entries)</td>
                    </tr>
                    <tr>
                        <td>DSP Blocks</td>
                        <td>33 units</td>
                        <td>32 MAC operations + 1 LeakyReLU multiplier</td>
                    </tr>
                    <tr>
                        <td>Logic Elements</td>
                        <td>Moderate</td>
                        <td>State machine, control logic, addressing</td>
                    </tr>
                    <tr>
                        <td>Registers</td>
                        <td>~2000</td>
                        <td>Pipeline registers, buffers, control signals</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>Design Efficiency</h3>
            <ul>
                <li><strong>Parallelism:</strong> 32-way SIMD operations per cycle</li>
                <li><strong>Throughput:</strong> 32 MAC operations + 1 LeakyReLU per clock cycle</li>
                <li><strong>Clock Frequency:</strong> Limited by FPGA fabric (typically 50-100 MHz)</li>
                <li><strong>Memory Bandwidth:</strong> Optimized through tiling and reuse</li>
            </ul>
        </div>

        <!-- Slide 12: Conclusion -->
        <div class="slide">
            <h2>Conclusion</h2>
            
            <h3>Key Achievements</h3>
            <div class="highlight">
                <ul>
                    <li>✓ Achieved <strong>23.47× speedup</strong> (1,056,573 ms → 42,561.49 ms)</li>
                    <li>✓ Maintained model accuracy <strong>≥72%</strong></li>
                    <li>✓ Designed efficient hardware-software co-design</li>
                    <li>✓ Implemented 32-way parallel processing architecture</li>
                    <li>✓ Successfully integrated with TensorFlow Lite Micro</li>
                </ul>
            </div>
            
            <h3>Technical Contributions</h3>
            <ul>
                <li>Custom Function Unit (CFU) for ASR acceleration</li>
                <li>Tiled convolution with im2col transformation</li>
                <li>Hardware LeakyReLU accelerator</li>
                <li>Sparse filter optimization for pruned models</li>
                <li>Efficient dual-buffer memory architecture</li>
            </ul>
            
            <h3>Future Work</h3>
            <ul>
                <li>Increase tile size for higher parallelism</li>
                <li>Optimize for higher sparsity levels (>50%)</li>
                <li>Implement additional layer types in hardware</li>
                <li>Explore quantization-aware training for better hardware efficiency</li>
                <li>Port design to larger FPGA for full model acceleration</li>
            </ul>
        </div>

        <!-- Slide 13: Thank You -->
        <div class="slide">
            <h1>Thank You!</h1>
            <div class="subtitle">Questions & Discussion</div>
            
            <div class="student-info" style="margin-top: 100px;">
                <p><strong>Swarnajit Bhattacharya</strong></p>
                <p>Student ID: 314540038</p>
                <p>NYCU | AAML 2025</p>
                <p>Thank You For Your Time</p>
                <p style="margin-top: 40px;">
                    <strong>Project Repository:</strong><br>
                    <a href="https://github.com/Swarnajitronty/AAML-2025-Final_Project.git" 
                       style="color: #667eea; text-decoration: none;">
                        AAML 2025 Final Project Specification
                    </a>
                </p>
            </div>
        </div>

        <!-- Navigation Controls -->
        <div class="controls">
            <button id="prevBtn" onclick="changeSlide(-1)">← Previous</button>
            <div class="slide-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">13</span>
            </div>
            <button id="nextBtn" onclick="changeSlide(1)">Next →</button>
        </div>
    </div>

    <script>
        let currentSlide = 1;
        const totalSlides = document.querySelectorAll('.slide').length;
        
        document.getElementById('totalSlides').textContent = totalSlides;
        
        function showSlide(n) {
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (n > totalSlides) currentSlide = totalSlides;
            if (n < 1) currentSlide = 1;
            
            slides.forEach(slide => slide.classList.remove('active'));
            slides[currentSlide - 1].classList.add('active');
            
            document.getElementById('currentSlide').textContent = currentSlide;
            
            prevBtn.disabled = currentSlide === 1;
            nextBtn.disabled = currentSlide === totalSlides;
        }
        
        function changeSlide(direction) {
            currentSlide += direction;
            showSlide(currentSlide);
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') changeSlide(-1);
            if (e.key === 'ArrowRight') changeSlide(1);
        });
        
        // Initialize
        showSlide(currentSlide);
    </script>
</body>
</html>
